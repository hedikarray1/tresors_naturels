<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>

    <ion-title class="ion-title-header-center">
      <img src="../../../assets/logo/logo2.png" />
    </ion-title>
    
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <ion-list>
    <ion-card>
      <ion-item class="item-cart" *ngFor="let p of panier" class="ion-text-wrap">
        <ion-thumbnail slot="start">
          <img src="{{p?.thumbnail}}" />
        </ion-thumbnail>
        <ion-label>
          <h3>{{p?.product_name}}</h3>
          <ion-row class="ion-align-items-center">
            <ion-col size="2" class="ion-align-self-center">
              <p>{{ p?.quantity }}</p>
            </ion-col>
            <ion-col size="2" class="ion-align-self-center"> x </ion-col>
            <ion-col size="2" class="ion-align-self-center">
              <p [innerHTML]="p?.price_html"></p>
            </ion-col>
          </ion-row>
        </ion-label>
      </ion-item>
      <ion-item class="item-total">
        <ion-grid>
          <ion-row>
            <ion-col size="9"> Sous-Total : </ion-col>
            <ion-col size="3" class="ion-text-end">
              {{totalPanier}} TND
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-card>
  </ion-list>

  <ion-card>
    <ion-card-header> EXPÉDITION ZONE </ion-card-header>
    <ion-radio-group mode="ios" [(ngModel)]="selectedzone"  (ngModelChange)="selectZone()">

      <ion-item *ngFor="let zone of shipping_zones ">
        <ion-label class="label-size">{{zone.name}}</ion-label>
        <ion-radio  slot="start" value="{{zone.id}}"></ion-radio>

      </ion-item>
    </ion-radio-group>
<!--
    <ion-item>
      <ion-select mode="ios" [(ngModel)]="selectedzone" (ionChange)="selectZone()" okText="Ok" cancelText="Annuler">
        <ion-select-option *ngFor="let zone of shipping_zones" value="{{zone.id}}">{{zone.name}}</ion-select-option>
      </ion-select>
    </ion-item>
-->
  </ion-card>
  <ion-card>
    <ion-card-header> EXPÉDITION </ion-card-header>
    <ion-radio-group mode="ios" [(ngModel)]="selectedpayment"   (ngModelChange)="selectMethod()">

      <ion-item *ngFor="let payment of payment_methodes">
        <ion-label class="label-size">
          {{payment.title}}
          <p *ngIf="payment.settings.cost.value != ''">
            {{payment.settings.cost.value }} TND
          </p>
        </ion-label>
        <ion-radio   slot="start" value="{{payment.id}}"></ion-radio>
      </ion-item>
    </ion-radio-group>
   
  </ion-card>

 
  <ion-card>
    <ion-button expand="block" fill="outline" color="dark" value="block" (click)="openAddCouponModal()">
      Ajouter code promo
    </ion-button>

    <ion-item-group *ngFor="let coup of coupon_data ; let i = index">
      <ion-item-divider>
        <ion-label>CODE PROMO :{{coup?.code}} </ion-label>
      </ion-item-divider>


      <ion-item>
        <ion-label>Reduction de -{{coup?.amount}} TND</ion-label>

        <ion-button (click)="suuprimerCoupon(i)" fill="clear" slot="end" color="dark">
          <ion-icon name="close" slot="end"></ion-icon>
        </ion-button>
      </ion-item>
    </ion-item-group>

  </ion-card>

  <ion-card>
    <ion-card-header> Vous allez gagner {{pointsGain}} points avec cette commande. </ion-card-header>
  </ion-card>

  <ion-card>
    <ion-item class="item-total">
      <ion-grid>
        <ion-row>
          <ion-col size="6"> Sous-Total : </ion-col>
          <ion-col size="6" class="ion-text-end"> {{totalPanier | number : '1.3-3'}} TND </ion-col>
        </ion-row>

        <ion-row *ngIf="coupon_data.length>0">
          <ion-col size="7"> Reduction code promo  </ion-col>
          <ion-col size="5" class="ion-text-end">
            - {{totalCoupon}} TND
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="6"> Frais de livraison : </ion-col>
          <ion-col size="6" class="ion-text-end">
            {{totalLaivraison | number : '1.3-3'}} TND
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="6"> Total : </ion-col>
          <ion-col size="6" class="ion-text-end">
            {{getTotalOrder() | number : '1.3-3' }} TND
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
  </ion-card>

  <ion-segment [(ngModel)]="segmentValue">
    <ion-segment-button value="Facturation" (click)="showSegment()" >
      <ion-label>Facturation</ion-label>
    </ion-segment-button>
    <ion-segment-button value="Livraison"  (click)="showSegment()" >
      <ion-label>Livraison</ion-label>
    </ion-segment-button>
  </ion-segment>

  <ion-card *ngIf="showFacturation" id="facturation-card">
    <ion-card-content>
      <ion-card-title>Informations de facturation</ion-card-title>
      <ion-item>
        <ion-label position="floating">Nom</ion-label>
        <ion-input [(ngModel)]="billing.last_name" placeholder="Votre nom"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Prenom</ion-label>
        <ion-input [(ngModel)]="billing.first_name" placeholder="Votre prenom"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Adresse 1</ion-label>
        <ion-input [(ngModel)]="billing.address_1" placeholder="Votre adresse 1"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Adresse 2</ion-label>
        <ion-input [(ngModel)]="billing.address_2" placeholder="Votre adresse 2"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Ville</ion-label>
        <ion-input [(ngModel)]="billing.city" placeholder="Votre ville"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Pays</ion-label>
        <ion-input [(ngModel)]="billing.country" placeholder="Votre pays"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Code postal</ion-label>
        <ion-input [(ngModel)]="billing.postcode" placeholder="code postal"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Email</ion-label>
        <ion-input placeholder="Votre adresse électronique" [(ngModel)]="billing.email"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Téléphone</ion-label>
        <ion-input placeholder="Votre numéro de téléphone" [(ngModel)]="billing.phone"></ion-input>
      </ion-item>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="showLivraison" id="facturation-card">
    <ion-card-content>
      <ion-card-title>Informations de livraison</ion-card-title>
      <ion-item>
        <ion-label position="floating">Nom</ion-label>
        <ion-input placeholder="Votre nom" [(ngModel)]="shipping.last_name"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Prenom</ion-label>
        <ion-input placeholder="Votre nom" [(ngModel)]="shipping.first_name"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Adresse 1</ion-label>
        <ion-input placeholder="Votre adresse 1" [(ngModel)]="shipping.address_1"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Adresse 2</ion-label>
        <ion-input placeholder="Votre adresse 2" [(ngModel)]="shipping.address_2"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Ville</ion-label>
        <ion-input placeholder="Votre ville" [(ngModel)]="shipping.city"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Pays</ion-label>
        <ion-input placeholder="Votre pays" [(ngModel)]="shipping.country"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Code postal</ion-label>
        <ion-input placeholder="code postal" [(ngModel)]="shipping.postcode"></ion-input>
      </ion-item>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-content>
      <ion-card-title>Ajouter un commentaire</ion-card-title>

      <ion-item>
        <ion-textarea [(ngModel)]="notes" placeholder="Remplissez vos notes..."></ion-textarea>
      </ion-item>
    </ion-card-content>
  </ion-card>

  <ion-button expand="block" fill="outline" color="dark" value="block" (click)="createOrder()">confirmer</ion-button>
</ion-content>